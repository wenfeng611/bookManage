<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/thymeleaf-extras-springsecurity3">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge"/>
    <meta http-equiv="Cache-Control" content="no-siteapp"/>
    <meta name="viewport"
          content="width=device-width, maximum-scale=1.0, initial-scale=1.0,initial-scale=1.0,user-scalable=no"/>
    <meta name="apple-mobile-web-app-capable" content="yes"/>
    <title>科天云客服</title>
    <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico?t=1487250759056"/>
    <link rel="stylesheet" href="/js/select/css/select2.min.css"/>
    <link rel="stylesheet" type="text/css" href="/js/kindeditor/themes/default/default.css">
    <link rel="stylesheet" href="/css/flexboxgrid.min.css">
    <link rel="stylesheet" href="/assets/vendor/layui/v1/css/layui.css"  media="all">
    <link rel="stylesheet" href="/assets/css/kefu.css">
    <link rel="stylesheet" href="/css/datatables.css">
    <link rel="stylesheet" href="/res/css.html">
    <link rel="stylesheet" href="/css/flexboxgrid.min.css">
    <style>
        table dl dt, table dl dd{float:left;margin-left:10px;}
    </style>
</head>

<body>
<div class="layui-layout layui-layout-content layui-hide">
    <div class="layui-side layui-bg-black">
        <div class="layui-side-scroll">
            <ul class="layui-nav layui-nav-tree" lay-filter="setting">
                <li class="layui-nav-item layui-nav-itemed">
                    <a class="layui-nav-title" href="javascript:;">外呼管理</a>
                    <dl class="layui-nav-child kty-nav-child plan-left-nav">
                        <dd>
                            <a href="/page/callplans/all.htm" class="plan-all">全部计划</a>
                        </dd>
                        <dd>
                            <a href="/page/callplans/all.htm" class="plan-draft">制定中计划</a>
                        </dd>
                        <dd>
                            <a href="/page/callplans/all.htm" class="plan-running">实施中计划</a>
                        </dd>
                        <dd>
                            <a href="/page/callplans/all.htm" class="plan-complete">已结束计划</a>
                        </dd>
                    </dl>
                </li>
            </ul>
        </div>
    </div>
    <div class="layui-body">
        <div class="layui-side-scroll">
            <div class="row">
                <div class="col-lg-12">
                    <h1 class="site-h12 ukefu-tab" style="border-top:1px solid #e6e6e6;height:26px;">
					<span class="ukefu-bt">
						<i class="layui-icon ukewo-btn" style="font-size:20px;"></i>
						<div class="ukefu-bt-text">
							<div class="ukefu-bt-text-title">
								全部计划
							</div>
						</div>
					</span>
                        <div class="ukefu-tab-title">
                            <ul class="tab-title plan-top-nav">
                                <li class="layui-this"><a class="plan-all">全部计划</a></li>
                                <li><a class="today-plan">今日新增</a></li>
                                <li><a class="week-plan">本周新增</a></li>
                                <li><a class="my-plan">我的计划</a></li>
                            </ul>
                        </div>
                        <div class="ukefu-bt-text-content"
                             style="position: absolute;right: 5px;top: 0px;padding-right:10px;">
                            <form class="layui-form" id="search-form"
                                  style="float: left;">
                                <div class="layui-form-item">
                                    <div class="layui-inline">
                                        <div class="layui-input-inline">
                                            <input type="text" name="q" id="search-q" value=""
                                                   style="height: 30px;line-height: 30px;border: 1px solid #32c24d;"
                                                   placeholder="请输入查询条件" autocomplete="off" class="layui-input">
                                            <i class="layui-icon" onclick="planListTable.fnDraw();"
                                               style="position: absolute;cursor: pointer;right: 3px;top: 4px;font-size: 20px;color:#32c24d;"></i>
                                        </div>
                                    </div>
                                </div>
                                <input type="hidden" value="" name="listtype" id="listtype"/>
                                <input type="hidden" value="" name="status" id="status"/>
                            </form>
                            <div class="layui-btn-group kefu-btn-group">
                                <a href="/page/callplans/add.htm" title="新建计划" data-toggle="ajax" data-width="800"
                                   data-height="610" class="layui-btn layui-btn-small">
                                    <i class="layui-icon"></i>
                                    新建计划
                                </a>
                            </div>

                            <!--<div class="layui-btn-group kefu-btn-group">-->
                                <!--<button class="layui-btn layui-btn-small" href="/apps/customer/imp.html" title="导入电话"-->
                                        <!--data-toggle="ajax" data-width="950" data-height="600">-->
                                    <!--<i class="kfont"></i> 导入-->
                                <!--</button>-->
                            <!--</div>-->
                        </div>
                    </h1>
                    <div id="main-kf-active-content">

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="/js/jquery-1.10.2.min.js"></script>
<script src="/js/jquery.form.js"></script>
<script src="/js/jquery.hotkeys.min.js"></script>

<script src="/js/select/js/select2.min.js"></script>
<script src="/js/select/js/i18n/zh-CN.js"></script>


<script src="/assets/vendor/layui/v1/layui.js"></script>
<script src="/js/ukefu.js"></script>
<script type="text/javascript" src="/js/kindeditor/kindeditor-min.js"></script>
<script type="text/javascript" src="/js/kindeditor/lang/zh-CN.js"></script>
<script src="/js/template.js"></script>

<script src="/js/weixinAudio.js"></script>
<script src="/js/echarts.common.min.js"></script>
<script language="javascript" src="/js/theme/wonderland.js"></script>
<script src="/js/datatables/jquery.dataTables.min.js"></script>
<script src="/js/datatables/dataTables.bootstrap.min.js"></script>
<script src="/js/datatable-responsive/datatables.responsive.min.js"></script>
<script src="/js/datatables/dataTables.tableTools.min.js"></script>
<script src="/js/datatables/dataTables.colVis.min.js"></script>
<script src="/js/active-content.js"></script>


<script>

    var listtype = '';
    var status = '';
    var planListTable = undefined;
    function initMenu() {

        $('.plan-top-nav').delegate('a', 'click', function() {
            var thisObj = $(this);
            if (thisObj.hasClass("plan-all")) {
                listtype = '';
            } else if (thisObj.hasClass("today-plan")) {
                listtype = 'today';
            } else if (thisObj.hasClass("week-plan")) {
                listtype = 'week';
            } else if (thisObj.hasClass("my-plan")) {
                listtype = 'mine';
            }
            $('#listtype').val(listtype);

            $('.ukefu-tab-title .tab-title li').removeClass('layui-this');
            thisObj.parent().addClass('layui-this');
            if(planListTable) {
                planListTable.fnDraw();
            }
            root.Console.log('listtype:', listtype);
        });
        $('.plan-left-nav a').bind('click', function () {
            var thisObj = $(this);
            if (thisObj.hasClass("plan-all")) {
                status = '';
            } else if (thisObj.hasClass("plan-draft")) {
                status = '0';
            } else if (thisObj.hasClass("plan-running")) {
                status = '1';
            } else if (thisObj.hasClass("plan-complete")) {
                status = '2';
            }
            $('#status').val(status);
            if(planListTable) {
                planListTable.fnDraw();
            }
            root.Console.log('status:', status);
            return false;
        });

    };

    //Html编码获取Html转义实体
    function htmlEncode(value) {
        return $('<div/>').text(value).html();
    }
    //Html解码获取Html实体
    function htmlDecode(value) {
        return $('<div/>').html(value).text();
    }

    var breakpointDefinition = {
        tablet: 1024,
        phone: 480
    };

    var pagefunction = undefined;

    function pageSetUp() {
        pagefunction = undefined;
    }

    function commonSetting4DataTable(tableSetting) {
        var sortIndex = -1;
        var orderby = tableSetting.orderby;

        $.each(tableSetting.columns, function (i, item) {
            if (orderby) {
                if (item.data && item.data == orderby) {
                    sortIndex = i;
                }
            } else {
                if (item.data && item.data === 'createtime') {
                    sortIndex = i;
                }
            }

            if (!item.className) {
                item.className = "center";
            }
            item["asSorting"] = ["desc", "asc"];
            if (typeof item.render !== 'function') {
                item.render = function (data, type, full) {
                    return (data || data === 0 ) ? data : "-";
                }
            } else {
                var tmpFun = item.render;
                item.render = function (data, type, full) {
                    var tmpText = tmpFun(data, type, full);

                    if (typeof tmpText === 'string') {
                        if (tmpText.indexOf('<') != -1) {
                            return tmpText;
                        } else {
                            return htmlEncode(tmpText);
                        }
                    } else {
                        return tmpText;
                    }
                }

            }
        });

        var columnLength = tableSetting.columns.length;
        var columnWith = 100 / columnLength;
        tableSetting.columns.forEach(function (value, index, array1) {
            value.defaultContent = "";
//            if (!value.width) {
//                value.width = columnWith + "%";
//            }
            if (!value.className) {
                value.className = "center";
            }
        });

        if (sortIndex >= 0) {

            if (tableSetting.direction) {
                tableSetting.order = [[sortIndex, tableSetting.direction]];
            } else {
                tableSetting.order = [[sortIndex, "desc"]];
            }
        }
        tableSetting.destroy = true;
        tableSetting.language = {
            lengthMenu: "每页显示 _MENU_ 条记录",
            zeroRecords: "没有检索到数据",
            emptyTable: "没有数据",
            info: "共有 _TOTAL_ 条记录",
            processing: "<div class=\"icon\"><i class=\"kfont\">&#xe63d;</i></div>",
            loadingRecords: "<div class=\"icon\"><i class=\"kfont\">&#xe63d;</i>正在载入。。。</div>",
            search: '<span class="input-group-addon"><i class="glyphicon glyphicon-search"></i></span>',
            infoEmpty: "共 0 条记录",
            stateSave: false,
            paginate: {
                first: "首页",
                previous: "前页",
                next: "后页",
                last: "尾页"
            },
        };

        //tableSetting.dom ="<'dt-toolbar'<'col-xs-12 col-sm-6'f><'col-sm-6 col-xs-12 hidden-xs'l>r>t<'dt-toolbar-footer'<'col-sm-6 col-xs-12 hidden-xs'i><'col-xs-12 col-sm-6'p>>",
        tableSetting.autoWidth = true;
        tableSetting.filter = false;
        tableSetting.serverSide = true;
        tableSetting.sAjaxDataProp = "datas";

        tableSetting.preDrawCallback = function () {
            // Initialize the responsive datatables helper once.
            if (!tableSetting.responsiveHelper_dt_basic) {
                tableSetting.responsiveHelper_dt_basic = new ResponsiveDatatablesHelper(tableSetting.table, breakpointDefinition);
            }
        };
        tableSetting.rowCallback = function (nRow) {
            if (tableSetting.responsiveHelper_dt_basic) {
                tableSetting.responsiveHelper_dt_basic.createExpandIcon(nRow);
            }
        };
        tableSetting.drawCallback = function (oSettings) {
            if (tableSetting.responsiveHelper_dt_basic) {
                tableSetting.responsiveHelper_dt_basic.respond();
                root.Console.log("Completed draw table!");
                layui.use('element', function () {
                    var element = layui.element();
                    element.init();
                    //…
                });
            }
        };

        return tableSetting.table.dataTable(tableSetting);
    }

    $(function () {

        initMenu();
        initAjaxLoadPage();
        $('.layui-layout-content.layui-hide').removeClass("layui-hide");

    });
    ajaxSetup();


</script>
</body>
</html>